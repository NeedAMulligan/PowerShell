Local Code-Signing Framework: OverviewThis system moves your machine from a "low-security" state (where any script can run) to a "Professional-Trust" state (where only your verified scripts can run).1. Workflow SummaryStepScript NameFrequencyPurpose1Create-SigningCert.ps1Once per 10 YearsGenerates your identity and tells Windows to trust it.2Set-LocalSecurityPolicy.ps1OnceLocks the machine down to only allow signed scripts.3Batch-SignScripts.ps1Whenever you codeApplies your digital signature to your .ps1 files.4Sign-MyScript.ps1As neededSigns a single specific script file.2. Detailed Component BreakdownStep 1: Establishing Trust (Create-SigningCert.ps1)Before you can sign scripts, you need a "Digital Seal."What it does: Creates a self-signed certificate and places it in the Trusted Root and Trusted Publisher stores.Critical Output: * .cer file (Public Key) - Safe to share..pfx file (Private Key) - Keep this secure! It is stored in C:\temp with the password you defined. Anyone with this file can pretend to be you.Step 2: Locking the System (Set-LocalSecurityPolicy.ps1)By default, Windows is often set to RemoteSigned or Unrestricted.What it does: Changes the system policy to AllSigned.The Result: If you try to run a script you just wrote without signing it, Windows will now block it. This prevents "Script-Kiddie" attacks or accidental execution of downloaded files.Step 3: The Developer Loop (Batch-SignScripts.ps1)This is your primary tool during active development.Usage: Point this script at your C:\Scripts folder.What it does: It looks at every script in the folder and applies your "SharePoint Online Certificate" signature.Timestamping: It connects to a Timestamp Authority (DigiCert) to verify when you signed the file, so it remains valid even after the certificate expires.3. Troubleshooting & MaintenanceWhy is my script still being blocked?Modified File: If you open a signed script, change one character, and save it, the signature is broken. You must re-sign it using the Batch or Single Signer.Trust Issue: Ensure the .cer file was successfully imported into Cert:\LocalMachine\Root. You can verify this by running certlm.msc.Moving to a new MachineIf you get a new workstation, you don't need to create a new cert. Simply:Copy your .pfx file to the new machine.Right-click the .pfx and select Install PFX.Place it in the Trusted Root and Trusted Publisher stores.4. Security Best PracticesThe PFX Password: The password in the script (P@ssword123) is a placeholder. For a production-grade setup, manually change this variable in the script before running it.Folder Permissions: Ensure only your user account has "Write" access to C:\temp and your scripts folder to prevent others from tampering with your signed files.
